import 'dart:async';

int counter = 0;

main(List<String> arguments) async {
  Duration duration = await Duration(seconds: 2);

  print('Iniciado: ${getTime()}');
  await Timer.periodic(await duration, await timeout);
  print('finalizado');
}

Future<void> timeout(Timer timer) async {
  print('Espera: ${getTime()}');

  counter++;
  if (counter >= 5) {
    await timer.cancel();
  }
}

String getTime() {
  DateTime dt = DateTime.now();
  return dt.toString();
}
